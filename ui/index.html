<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeatMemo - Infinite Canvas</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- 画面0: 認証 -->
    <div id="view-auth" class="view">
        <div class="auth-container">
            <h1>NeatMemo</h1>
            
            <!-- サインイン -->
            <div id="auth-signin">
                <h2>ログイン</h2>
                <input type="email" id="signin-email" placeholder="メールアドレス">
                <input type="password" id="signin-password" placeholder="パスワード">
                <button id="btn-signin" class="primary-btn full-width">ログイン</button>
                <p class="auth-link">アカウントをお持ちでない方は <a href="#" id="link-signup">新規登録</a></p>
            </div>

            <!-- サインアップ -->
            <div id="auth-signup" style="display: none;">
                <h2>新規登録</h2>
                <input type="email" id="signup-email" placeholder="メールアドレス">
                <input type="password" id="signup-password" placeholder="パスワード">
                <button id="btn-signup" class="primary-btn full-width">登録</button>
                <p class="auth-link">既にアカウントをお持ちの方は <a href="#" id="link-signin">ログイン</a></p>
            </div>

            <!-- 確認コード -->
            <div id="auth-confirm" style="display: none;">
                <h2>確認コード入力</h2>
                <p>メールアドレスに送信されたコードを入力してください。</p>
                <input type="text" id="confirm-email-hidden" hidden>
                <input type="text" id="confirm-code" placeholder="確認コード">
                <button id="btn-confirm" class="primary-btn full-width">確認</button>
                <button id="btn-confirm-back" class="secondary-btn full-width" style="margin-top: 10px;">戻る</button>
            </div>
            
            <p id="auth-message" style="color: red; margin-top: 10px;"></p>
        </div>
    </div>

    <!-- 画面1: プロジェクト一覧 -->
    <div id="view-project-list" class="view" style="display: none;">
        <header id="project-header">
            <h1>NeatMemo</h1>
            <button id="btn-logout" class="secondary-btn">ログアウト</button>
        </header>
        <div id="project-actions">
            <button id="btn-new-project" class="primary-btn">+ 新規プロジェクト</button>
        </div>
        <div id="project-grid">
            <!-- 動的にProjectCardが追加される -->
        </div>
    </div>

    <!-- 画面2: キャンバス -->
    <div id="view-canvas" class="view" style="display: none;">
        <!-- ナビゲーションバー -->
        <div id="canvas-navbar">
            <button id="btn-back" class="nav-btn">← 戻る</button>
            <span id="current-project-name"></span>
        </div>

        <!-- ツールバー -->
        <div id="toolbar">
            <button class="tool-btn active" id="btn-text" title="ダブルクリックで配置">テキスト</button>
            <button class="tool-btn" id="btn-ocr" title="画像からテキスト抽出">OCR</button>
            <button class="tool-btn" id="btn-image" title="画像をそのまま配置">画像</button>
            <button class="tool-btn" id="btn-pen" title="ペンで描画">ペン</button>
            <button class="tool-btn" id="btn-save">保存</button>
        </div>

        <!-- 隠しファイル入力（画像アップロード用） -->
        <input type="file" id="ocr-input" accept="image/png,image/jpeg,image/jpg" hidden>
        <input type="file" id="image-input" accept="image/png,image/jpeg,image/jpg" hidden>

        <!-- ドラッグ&ドロップオーバーレイ -->
        <div id="drop-overlay">
            <div class="drop-overlay-content">
                <span class="drop-icon">📷</span>
                <span>画像をドロップして配置</span>
            </div>
        </div>

        <!-- ローディングオーバーレイ -->
        <div id="loading-overlay">
            <div class="loading-content">
                <div class="spinner"></div>
                <span>OCR処理中...</span>
            </div>
        </div>

        <!-- キャンバス領域 -->
        <div id="canvas-area">
            <!-- ここに動的に要素が追加されます -->
        </div>

        <!-- 右クリックメニュー -->
        <div id="context-menu" class="context-menu">
            <button class="context-menu-item" data-action="add-text">テキストを追加</button>
            <button class="context-menu-item" data-action="add-ocr">OCRで画像からテキスト抽出</button>
            <button class="context-menu-item" data-action="add-image">画像を追加</button>
            <button class="context-menu-item" data-action="add-pen">ペンで描画</button>
        </div>
    </div>

    <!-- プロジェクト名入力モーダル -->
    <div id="project-modal" class="modal">
        <div class="modal-content">
            <h2 id="modal-title">新規プロジェクト</h2>
            <input type="text" id="project-name-input" placeholder="プロジェクト名を入力" autocomplete="off">
            <div class="modal-actions">
                <button id="modal-cancel" class="modal-btn">キャンセル</button>
                <button id="modal-confirm" class="modal-btn primary">作成</button>
            </div>
        </div>
    </div>


    <!-- トースト通知コンテナ -->
    <div id="toast-container"></div>

    <!-- 設定読み込み -->
    <script src="/config.js"></script>
    <script type="module" src="./app.js"></script>
</body>
</html>
